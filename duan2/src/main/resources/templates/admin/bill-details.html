<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi tiết đặt phòng</title>
    <link rel="icon" href="/client/images/logo-hotel-removebg.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="shortcut icon" href="./favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Bamburgh HTML5 Admin Dashboard with Bootstrap PRO Stylesheets -->

    <link rel="stylesheet" type="text/css" href="/admin/css/bamburgh.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"
        integrity="sha512-b94Z6431JyXY14iSXwgzeZurHHRNkLt9d6bAHt7BZT38eqV+GyngIi/tVye4jBKPYQ2lBdRs0glww4fmpuLRwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        .css-1hta359 {
            padding: 1.25rem;
        }

        .css-title {
            box-sizing: border-box;
            margin: 0px;
            flex-direction: row;
            max-width: 100%;
        }

        .css-p {
            margin: 0px 0px 0.25rem;
            line-height: 1.5;
            letter-spacing: 0.15px;
            font-weight: 400;
            font-size: 0.975rem;
            color: rgba(58, 53, 65, 0.6);
        }
    </style>

</head>

<body id="app-top">

    <div class="app-wrapper">
        <th:block th:insert="~{/admin/menu}"></th:block>
        <div class="app-main">
            <th:block th:insert="~{/admin/header}"></th:block>
            <div class="app-content">
                <div class="app-content--inner">
                    <div class="page-title">
                        <div class="row">
                            <div class="col-xl-7">
                                <div>
                                    <ol class="breadcrumb text-uppercase font-size-xs p-0">
                                        <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                                        <li class="breadcrumb-item"><a href="#">Hóa đơn</a></li>
                                        <li class="breadcrumb-item active" aria-current="page">Danh sách hóa đơn</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="container">
                        <div class="card card-box mb-5">
                            <div class="card-header pr-2">
                                <div class="card-header--title">
                                    <b>Hóa đơn chi tiết</b>
                                </div>

                            </div>
                            <div class="card-body p-0">
                                <div class="row css-1hta359 ">
                                    <div class="col css-title">
                                        <div class="title--bill" style="margin-bottom: 1.5rem;">
                                            <h4>Hotel FPT</h4>
                                        </div>
                                        <div class="">
                                            <p class="css-p">137 Nguyễn Thị Thập, Liên Chiểu, Đà Nẵng</p>
                                            <!-- <p class="css-p">+1 (34) 456 7891, +44 (34) 543 2198</p> -->

                                        </div>
                                    </div>
                                    <div class="col css-title">
                                        <div style="justify-content: flex-end !important; padding-left: 280px;">
                                            <div class="title--id" style="margin-bottom: 1.5rem;">
                                                <h4>Thông tin hóa đơn</h4>
                                            </div>
                                            <div>
                                                <p class="css-p" th:text="'Ngày tạo : ' + ${booking.createAt}"></p>
                                                <p class="css-p" th:text="'Ngày nhập phòng : ' + ${booking.checkInAt}">
                                                </p>
                                                <p class="css-p" th:text="'Ngày trả phòng : ' + ${booking.checkOutAt}">
                                                </p>
                                            </div>

                                        </div>


                                    </div>
                                </div>
                                <!-- <div class="row css-title" style="border-top: 1px solid #4532; ">
                                <div class="col-ms-6" style="padding-left: 20px; padding-top: 10px;">
                                    <div>
                                        <h4 class="">Bill To:</h4>
                                        <div class="">
                                            <table class="">
                                                <tbody class="">
                                                <tr>
                                                    <td class="css-p">
                                                        Total bill:</td>
                                                    <td class="css-p">
                                                        $12,110.55</td>
                                                </tr>
                                                <tr>
                                                    <td class="css-p">
                                                        Bank name:</td>
                                                    <td class="css-p">
                                                        VNPAY</td>
                                                </tr>
                                                <tr>
                                                    <td class="css-p">
                                                        Country:</td>
                                                    <td class="css-p">
                                                        VietName</td>
                                                </tr>
                                                <tr>
                                                    <td class="css-p">
                                                        IBAN(STK):</td>
                                                    <td class="css-p">
                                                        ETD95476213874685</td>
                                                </tr>
                                                <tr>
                                                    <td class="css-p">
                                                        Customer:</td>
                                                    <td class="css-p">
                                                        Ngõ Văn Môi</td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                            </div> -->
                                <div class="row css-title" style="border-top: 1px solid #4532; padding-bottom: 10px; ">
                                    <div class="col d-flex"
                                        style="padding-left: 20px; padding-top: 10px; position: relative; ">
                                        <div class="div d-flex">
                                            <div style="height: 130px; padding-right: 20px;">
                                                <img src="/assets/img/Bedroom-Apartment-3.jpg" alt=""
                                                    style="border-radius: 4px;height: 100%;">

                                            </div>
                                            <div>
                                                <h5 style="padding-top: 5px; color: #333; font-weight: 500;"
                                                    th:text="${booking.room.name}"></h5>
                                                <p class="css-p" style="font-weight: 600;"
                                                    th:text="${booking.room.type}"></p>
                                                <p class="css-p" style="font-weight: 600;"
                                                    th:text="${booking.room.quantityBed + ' giường'}"></p>
                                                <p class="css-p" style="font-weight: 600;"
                                                    th:text="${booking.room.acreage + ' người / phòng'}"></p>
                                            </div>

                                        </div>


                                    </div>

                                </div>
                                <div class="row css-title" style="border-top: 1px solid #4532; ">
                                    <div class="col " style="padding-top: 10px;">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Nội Dung</th>
                                                    <th>Dữ liệu</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Tên khách hàng</td>
                                                    <td th:text="${booking.user.fullname}"></td>
                                                </tr>
                                                <tr>
                                                    <td>SDT</td>
                                                    <td th:text="${booking.user.phone}"></td>
                                                </tr>


                                                <tr>
                                                    <td>Trạng thái</td>
                                                    <td th:text="${booking.status}"></td>
                                                </tr>
                                                <tr>
                                                    <td>Phương thức thanh toán</td>
                                                    <td
                                                        th:text="${booking.paymentMethod.toString() == 'CASH'?'Tiền mặt':'VN PAY'}">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Trạng thái thanh toán</td>
                                                    <td
                                                        th:text="${booking.paymentStatus.toString() == 'UNPAID'?'Chưa thanh toán':'Đã thanh toán'}">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Tiền phòng</td>
                                                    <td
                                                        th:text="${#numbers.formatDecimal(booking.room.price, 3, 'POINT', 0, 'COMMA') + ' VNĐ'}">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Dịch vụ</td>
                                                    <td>
                                                        <ul>
                                                            <li th:each="item : ${booking.allFacility}"> <b
                                                                    class="w-100"
                                                                    th:text="${item.name + ' - ' + #numbers.formatDecimal(item.price, 1, 'POINT', 0, 'COMMA') + ' VNĐ'}"></b>
                                                                <br>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Giảm giá</td>
                                                    <td
                                                        th:text="${#numbers.formatDecimal(- booking.discount, 1, 'POINT', 0, 'COMMA') + ' VNĐ'}">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                                <div>

                                </div>
                                <div class="row css-1hta359 ">

                                    <div class="col css-title">
                                        <div class="title--bill" style="margin-bottom: 1.5rem;">
                                            <h4>THÀNH TIỀN </h4>
                                        </div>

                                    </div>
                                    <div class="col css-title">
                                        <div style="justify-content: flex-end !important; padding-left: 280px;">
                                            <div class="title--id" style="margin-bottom: 1.5rem;">
                                                <h4 style="color: red;"
                                                    th:text="${ #numbers.formatDecimal(booking.total, 1, 'POINT', 0, 'COMMA') + ' VNĐ'}">
                                                </h4>
                                            </div>


                                        </div>


                                    </div>
                                </div>

                                <div class="w-100 d-flex justify-content-end p-3 ">

                                    <button class="btn btn-danger mr-3"
                                        th:if="${booking.status.toString() != 'CANCELLED'}"
                                        onclick="cancelBooking()">Hủy đơn</button>

                                    <button class="btn btn-primary" onclick="updateStatus()">Chuyển trạng thái</button>



                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <th:block th:insert="~{/admin/footer}"></th:block>
            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="vendor/bootstrap.min.js"></script>

    <script>

        function updateStatus() {

            var id = '[[${booking.id}]]'

            if (!id) {
                Swal.fire({
                    title: "Thông báo!",
                    text: "Đã xảy ra lỗi vui lòng kiểm tra lại!",
                    icon: "error"
                });

                return;
            }


            axios.put("/admin/booking/update/" + id)
                .then(res => {
                    Swal.fire({
                        title: "Thông báo!",
                        text: res.data,
                        icon: "success",
                        willClose: () => {
                            // Chuyển hướng sang trang khác sau khi người dùng nhấn OK
                            window.location.href = "/admin/booking";
                        }
                    });
                })
                .catch(err => {
                    Swal.fire({
                        title: "Thông báo!",
                        text: "Đã xảy ra lỗi vui lòng kiểm tra lại!",
                        icon: "error"
                    });
                })
        }

        function cancelBooking() {

            Swal.fire({
                title: "Bạn có chắc chắn muốn hủy phòng không?",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Hủy !"
            }).then((result) => {
                if (result.isConfirmed) {
                    var id = '[[${booking.id}]]'

                    if (!id) {
                        Swal.fire({
                            title: "Thông báo!",
                            text: "Đã xảy ra lỗi vui lòng kiểm tra lại!",
                            icon: "error"
                        });

                        return;
                    }

                    axios.put("/admin/booking/cancel/" + id)
                        .then(res => {
                            Swal.fire({
                                title: "Thông báo!",
                                text: res.data,
                                icon: "success",
                                willClose: () => {
                                    // Chuyển hướng sang trang khác sau khi người dùng nhấn OK
                                    window.location.href = "/admin/booking";
                                }
                            });
                        })
                        .catch(err => {
                            Swal.fire({
                                title: "Thông báo!",
                                text: "Đã xảy ra lỗi vui lòng kiểm tra lại!",
                                icon: "error"
                            });
                        })
                }
            });


        }

    </script>

    <!--Bootstrap init-->

    <script src="/admin/js/bootstrap.min.js"></script>

    <!--MetisMenu-->

    <script src="/admin/vendor/metismenu.min.js"></script>

    <!--MetisMenu init-->

    <script src="/admin/js/metismenu.min.js"></script>

    <!--Perfect scrollbar-->

    <script src="/admin/vendor/perfect-scrollbar.min.js"></script>

    <!--Perfect scrollbar init-->

    <script src="/admin/js/perfect-scrollbar.min.js"></script>

    <!--FeatherIcons-->

    <script src="/admin/vendor/feather-icons.min.js"></script>

    <!--FeatherIcons init-->

    <script src="/admin/js/feather-icons.min.js"></script>

    <!--Layout-->

    <script src="/admin/js/bamburgh.min.js"></script>
</body>

</html>